SecurityEvent | where EventID == "4688" | where ((Image endswith "\\wscript.exe" or Image endswith "\\cscript.exe" and CommandLine matches regex ".* C:\\Users\\\.*\.jse .*" or CommandLine matches regex ".* C:\\Users\\\.*\.vbe .*" or CommandLine matches regex ".* C:\\Users\\\.*\.js .*" or CommandLine matches regex ".* C:\\Users\\\.*\.vba .*" or CommandLine matches regex ".* C:\\Users\\\.*\.vbs .*" or CommandLine matches regex ".* C:\\ProgramData\\\.*\.jse .*" or CommandLine matches regex ".* C:\\ProgramData\\\.*\.vbe .*" or CommandLine matches regex ".* C:\\ProgramData\\\.*\.js .*" or CommandLine matches regex ".* C:\\ProgramData\\\.*\.vba .*" or CommandLine matches regex ".* C:\\ProgramData\\\.*\.vbs .*") and not (ParentImage contains "\\winzip"))

//Version 2
SecurityEvent 
| where EventID == "4688" 
| where ((NewProcessName endswith "\\wscript.exe" or NewProcessName endswith "\\cscript.exe" and CommandLine matches regex @".* C:\\Users\\\.*\.jse .*" or CommandLine matches regex @".* C:\\Users\\\.*\.vbe .*" or CommandLine matches regex @".* C:\\Users\\\.*\.js .*" or CommandLine matches regex @".* C:\\Users\\\.*\.vba .*" or CommandLine matches regex @".* C:\\Users\\\.*\.vbs .*" or CommandLine matches regex @".* C:\\ProgramData\\\.*\.jse .*" or CommandLine matches regex @".* C:\\ProgramData\\\.*\.vbe .*" or CommandLine matches regex @".* C:\\ProgramData\\\.*\.js .*" or CommandLine matches regex @".* C:\\ProgramData\\\.*\.vba .*" or CommandLine matches regex @".* C:\\ProgramData\\\.*\.vbs .*") and not (ParentProcessName contains "\\winzip"))

//
SecurityEvent
| where CommandLine matches regex @".* C:\\Windows\\.*\.exe .*"
